<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/night.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <style>
      circle{
        fill:white;
        stroke:steelblue;  
        stroke-width:2px;
      }
      line{
        stroke:grey;
        stroke-width:3px;
      }
      img {
        border:0px;
      }
      #g_labels text {
        text-anchor: middle;
        font-size:25px;
      }
      #g_labels_red text {
        fill: red;
        font-size:15px;
      }
      #g_labels_green text {
        fill: green;
        font-size:15px;
      }
      #g_labels_white text {
        fill: white;
        font-size:25px;
      }
      #left {
        left:-8.33%;
        text-align: left;
        float: left;
        width:33%;
        z-index:-10;
      }
      
      #right {
        left:31.25%;
        top: 75px;
        float: right;
        text-align: right;
        z-index:-10;
        width:33%;
      }

    </style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h1>Gradient Descent</h1>
        </section>
        <section>
          <h1>Objetivo</h1>
          <p>Crear de un agente que pueda aprender a jugar el videojuego Breakout a partir de la secuencia de matrices de pixeles que         constituyen el juego. Para lograr esto, se propone el uso de una red neuronal utilizando el método clásicos de optimización         descenso de gradiente. La entrada de la red sería la matriz de pixeles y la salida es un elemento del espacio de acciones         que el agente puede tomar.</p>
        </section>

        <section data-background-video="./videos/16-points.mp4" data-background-video-loop data-background-video-muted>
        </section>
        <section>
          <img src="./images/turing.jpg"/>
        </section>
        

        <section>
          <img src="./images/gradient_descent_line_graph.gif"/>
        </section>

        <section>
          <h3>The chain rule</h3>

          \[ \begin{align}
          \frac{dz}{{dx}} &= \frac{dz}{{du}}\frac{{du}}{{dx}} 
            \end{align}
          \]
        </section>
        <section>
          <div id="left">
            <svg width="500" height="600" id="treesvg">
              <g id="g_lines"><line x1="200" y1="50" x2="200" y2="250"></line><line x1="200" y1="250" x2="100" y2="450"></line><line x1="200" y1="250" x2="300" y2="450"></line></g>
              <g id="g_circles">
                <circle cx="200" cy="50" r="50"></circle>
                <circle cx="200" cy="250" r="50"></circle>
                <circle cx="100" cy="450" r="50"></circle>
                <circle cx="300" cy="450" r="50"></circle>
              </g>
              <g id="g_labels_green">
                <text x="200" y="50" >f</text>
                <text x="200" y="250">g</text>
                <text x="100" y="450">x</text>
                <text x="300" y="450">y</text>
              </g>
              <g id="g_labels_red">
                <text x="220" y="160" >df/dg</text>
                <text x="150" y="375">dg/dx</text>
                <text x="275" y="375">dg/dy</text>
                <text x="0" y="550">df/dx = df/dg * dg/dx</text>
                <text x="250" y="550">df/dy = df/dg * dg/dy</text>
              </g>
            </svg>
          </div>
          <div id="right">
            \[
              \begin{align}
              f(x) &= x \\
              g(x,y) &= xy \\
              \frac{dg}{dx} &= y \quad \frac{dg}{dy} = x \\
              x&=3, \quad y=4\\
              f(g(x,y))&= 12 \\
              \frac{df}{dx}&= \frac{df}{dg} \frac{dg}{dx} = 4 \\
                \frac{df}{dy}&= \frac{df}{dg} \frac{dg}{dy} = 3 
              \end{align}
            \]
          </div>
        </section>
        <section>
          <div>
            \[
            f(x,y,z,w,c) = \frac{1}{1+e^{-(xy + zw + c)}}
            \]
          </div>
          <div id="left">
          <svg width="958" height="920" id="treesvg"><g id="g_lines"><line x1="300" y1="30" x2="300" y2="100"></line><line x1="300" y1="100" x2="300" y2="170"></line><line x1="300" y1="170" x2="300" y2="240"></line><line x1="300" y1="240" x2="300" y2="310"></line><line x1="300" y1="310" x2="265" y2="380"></line><line x1="300" y1="310" x2="440" y2="380"></line><line x1="265" y1="380" x2="195" y2="450"></line><line x1="265" y1="380" x2="335" y2="450"></line><line x1="195" y1="450" x2="160" y2="520"></line><line x1="195" y1="450" x2="230" y2="520"></line><line x1="335" y1="450" x2="300" y2="520"></line><line x1="335" y1="450" x2="370" y2="520"></line></g>
          <g id="g_circles">
          <circle cx="300" cy="30" r="20"></circle>
          <circle cx="300" cy="100" r="20"></circle>
          <circle cx="300" cy="170" r="20"></circle>
          <circle cx="300" cy="240" r="20"></circle>
          <circle cx="300" cy="310" r="20"></circle>
          <circle cx="265" cy="380" r="20"></circle>
          <circle cx="440" cy="380" r="20"></circle>
          <circle cx="195" cy="450" r="20"></circle>
          <circle cx="335" cy="450" r="20"></circle>
          <circle cx="160" cy="520" r="20"></circle>
          <circle cx="230" cy="520" r="20"></circle>
          <circle cx="300" cy="520" r="20"></circle>
          <circle cx="370" cy="520" r="20"></circle>
          </g>
          <g id="g_labels">
          <text x="300" y="40" >1/x</text>
          <text x="300" y="110" >+1</text>
          <text x="300" y="180" >exp</text>
          <text x="300" y="250" >*-1</text>
          <text x="300" y="320" >+</text>
          <text x="265" y="390" >+</text>
          <text x="440" y="390" >c</text>
          <text x="195" y="460" >*</text>
          <text x="335" y="460" >*</text>
          <text x="160" y="530" >x</text>
          <text x="230" y="530" >y</text>
          <text x="300" y="530" >z</text>
          <text x="370" y="530" >w</text>
          </g>
          <g id="g_labels_green">
          <text x="320" y="30" >0.73</text>
          <text x="320" y="100" >1.37</text>
          <text x="320" y="170" >0.37</text>
          <text x="320" y="240" >-1.0</text>
          <text x="320" y="310" >1.0</text>
          <text x="285" y="380" >4.0</text>
          <text x="460" y="380" >-3.0</text>
          <text x="215" y="450" >-2.0</text>
          <text x="355" y="450" >6.0</text>
          <text x="180" y="520" >2.0</text>
          <text x="250" y="520" >-1.0</text>
          <text x="320" y="520" >-3.0</text>
          <text x="390" y="520" >-2.0</text>
          </g>
          <g id="g_labels_red">
          <text x="320" y="50" >1.0</text>
          <text x="320" y="120" >-0.53</text>
          <text x="320" y="190" >-0.53</text>
          <text x="320" y="260" >-0.2</text>
          <text x="320" y="330" >0.2</text>
          <text x="285" y="400" >0.2</text>
          <text x="460" y="400" >0.2</text>
          <text x="215" y="470" >0.2</text>
          <text x="355" y="470" >0.2</text>
          <text x="180" y="540" >0.2</text>
          <text x="250" y="540" >0.4</text>
          <text x="320" y="540" >-0.4</text>
          <text x="390" y="540" >0.6</text>
          </g>
          </svg>
          </div>
          <div id="right">
            \[ \begin{align}
            \frac{d }{{dx}} e^x &= e^x \\
            \frac{d }{{dx}} (x + c) &= 1 \\
            \frac{d}{dx}xy &= y \\
            \frac{d}{dy}xy &= x
            \end{align}
            \]
          </div>
        </section>
        <section>
            \[ \begin{align}
              \sigma(x) &= \frac{1}{1 + e^{-x}} \\
              \frac{d\sigma(x)}{dx} &= \frac{e^{-x}}{(1 + e^{-x})^2} \\
                          &= \left(\frac{1 + e^{-x} - 1}{1 + e^{-x}}\right)\left(\frac{1}{1 +   e^{-x}}\right) \\
                          &= (1 - \sigma(x))\sigma(x)
              \end{align}
            \]
        </section>
        <section>
          <div>
            \[
            \sigma(x) = \frac{1}{1+e^{-x}}
            \]
          </div>
          <div id="left">
          <svg width="958" height="920" id="treesvg"><g id="g_lines"><line x1="300" y1="30" x2="300" y2="100"></line><line x1="300" y1="100" x2="300" y2="170"></line><line x1="300" y1="170" x2="300" y2="240"></line><line x1="300" y1="240" x2="300" y2="310"></line><line x1="300" y1="310" x2="265" y2="380"></line><line x1="300" y1="310" x2="440" y2="380"></line><line x1="265" y1="380" x2="195" y2="450"></line><line x1="265" y1="380" x2="335" y2="450"></line><line x1="195" y1="450" x2="160" y2="520"></line><line x1="195" y1="450" x2="230" y2="520"></line><line x1="335" y1="450" x2="300" y2="520"></line><line x1="335" y1="450" x2="370" y2="520"></line></g>
          <g id="g_circles">
          <circle cx="300" cy="30" r="20"></circle>
          <circle cx="300" cy="100" r="20"></circle>
          <circle cx="300" cy="170" r="20"></circle>
          <circle cx="300" cy="240" r="20"></circle>
          <circle cx="300" cy="310" r="20"></circle>
          <circle cx="265" cy="380" r="20"></circle>
          <circle cx="440" cy="380" r="20"></circle>
          <circle cx="195" cy="450" r="20"></circle>
          <circle cx="335" cy="450" r="20"></circle>
          <circle cx="160" cy="520" r="20"></circle>
          <circle cx="230" cy="520" r="20"></circle>
          <circle cx="300" cy="520" r="20"></circle>
          <circle cx="370" cy="520" r="20"></circle>
          </g>
          <g id="g_labels">
          <text x="300" y="40" >1/x</text>
          <text x="300" y="110" >+1</text>
          <text x="300" y="180" >exp</text>
          <text x="300" y="250" >*-1</text>
          <text x="300" y="320" >+</text>
          <text x="265" y="390" >+</text>
          <text x="440" y="390" >c</text>
          <text x="195" y="460" >*</text>
          <text x="335" y="460" >*</text>
          <text x="160" y="530" >x</text>
          <text x="230" y="530" >y</text>
          <text x="300" y="530" >z</text>
          <text x="370" y="530" >w</text>
          </g>
          <g id="g_labels_green">
          <text x="320" y="30" >0.73</text>
          <text x="320" y="100" >1.37</text>
          <text x="320" y="170" >0.37</text>
          <text x="320" y="240" >-1.0</text>
          <text x="320" y="310" >1.0</text>
          <text x="285" y="380" >4.0</text>
          <text x="460" y="380" >-3.0</text>
          <text x="215" y="450" >-2.0</text>
          <text x="355" y="450" >6.0</text>
          <text x="180" y="520" >2.0</text>
          <text x="250" y="520" >-1.0</text>
          <text x="320" y="520" >-3.0</text>
          <text x="390" y="520" >-2.0</text>
          </g>
          <g id="g_labels_red">
          <text x="320" y="50" >1.0</text>
          <text x="320" y="120" >-0.53</text>
          <text x="320" y="190" >-0.53</text>
          <text x="320" y="260" >-0.2</text>
          <text x="320" y="330" >0.2</text>
          <text x="285" y="400" >0.2</text>
          <text x="460" y="400" >0.2</text>
          <text x="215" y="470" >0.2</text>
          <text x="355" y="470" >0.2</text>
          <text x="180" y="540" >0.2</text>
          <text x="250" y="540" >0.4</text>
          <text x="320" y="540" >-0.4</text>
          <text x="390" y="540" >0.6</text>
          </g>
          <g>
            <rect x="200" y="3" width="200" height="340"
              style="stroke:blue;stroke-width:5;fill-opacity:0;stroke-opacity:0.9" />
          </g>
          </svg>
          </div>

          <div id="right">
            \[
            \begin{align}
            \sigma(1) &= \frac{1}{1+e^{-1}} \\
                  &\approx 0.73 \\
            \frac{d\sigma(1)}{dx} &= (1 - \sigma(1))\sigma(1) \\
                        &\approx (1 - 0.73)(0.73) \\
                        &\approx 0.2
            \end{align}
            \]
          </div>
        </section>
        <section> 
          <pre><code class="c++" data-trim contenteditable>
void SigmoidLayer<Dtype>::Forward_cpu(const vector<Blob<Dtype>*>& bottom, const vector<Blob<Dtype>*>& top) {
  const Dtype* bottom_data = bottom[0]->cpu_data();
  Dtype* top_data = top[0]->mutable_cpu_data();
  const int count = bottom[0]->count();
  for (int i = 0; i < count; ++i) {
    top_data[i] = sigmoid(bottom_data[i]);
  }
}
          </code>
          </pre>
        </section>
        <section>
          <pre><code class="c++" data-trim contenteditable>
void SigmoidLayer<Dtype>::Backward_cpu(const vector<Blob<Dtype>*>& top, const vector<bool>& propagate_down, const vector<Blob<Dtype>*>& bottom) {
  if (propagate_down[0]) {
    const Dtype* top_data = top[0]->cpu_data();
    const Dtype* top_diff = top[0]->cpu_diff();
    Dtype* bottom_diff = bottom[0]->mutable_cpu_diff();
    const int count = bottom[0]->count();
    for (int i = 0; i < count; ++i) {
      const Dtype sigmoid_x = top_data[i];
      bottom_diff[i] = top_diff[i] * sigmoid_x * (1. - sigmoid_x);
    }
  }
}
          </code>
          </pre>
        </section>
        <section>
          <pre><code class="c++" data-trim contenteditable>
inline Dtype sigmoid(Dtype x) {
  return 0.5 * tanh(0.5 * x) + 0.5;
}
          </code>
          </pre>
        </section>
        <section>
          <h1>Activation Functions</h1>
        </section>
        <section>
          <img src="./images/functions2.png">
        </section>
        <section>
          <img src="./images/relufamily.png">
        </section>
        <section>
          <h1>Pooling</h1>
        </section>
        <section>
          <img src="./images/Pooling_schematic.gif">
        </section>
        <section>
            <h1 id="Bibliografía">Bibliografía<a class="anchor-link" href="#Bibliografía"></a></h1>
            <p>[1] L. Bottou, F. E. Curtis, and J. Nocedal. Optimization methods for large-scale machine learning. CoRR, abs/1606.04838, 2016.<br>
               [2] L. Bottou, O. Bousquet, The tradeoffs of large scale learning. In Proc. Advances in Neural Information Processing Systems 20 161–168 (2007).<br>
               [3] Y. A. LeCun, L. Bottou, G. B. Orr, K.R. Müller. Efficient backprop. Neural networks: Tricks of the trade, pages 9–48. Springer, 1998</p>
        </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/math/math.js', async: true },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
  </body>
</html>
